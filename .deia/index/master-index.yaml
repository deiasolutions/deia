# DEIA Global Commons Master Index
# Version 1.0 - Production Ready
# Last updated: 2025-10-16T17:30:00Z

version: "1.0"
last_updated: "2025-10-16T23:25:00Z"
total_documents: 15  # Public documents only (excludes 5 internal incidents)
total_clusters: 7    # Public clusters (excludes internal observability cluster)

metadata:
  maintainer: "LIBRARIAN-001 (future)"
  source_repo: "deiasolutions"
  index_format_version: "1.0"
  status: "production"
  taxonomy_source: "Claude Code practical taxonomy (2025-10-16)"
  notes: "Clusters organized by user mental models, not directory structure"

# ==============================================================================
# CONTENT CLUSTERS
# Organization based on how users/agents think about problems
# Multiple access paths: problem → cluster → docs
# ==============================================================================

clusters:

  # ---------------------------------------------------------------------------
  # CLUSTER 1: Deployment Safety & Recovery
  # ---------------------------------------------------------------------------
  deployment-safety:
    description: "Preventing and recovering from deployment disasters"
    keywords:
      - deployment
      - production
      - outage
      - recovery
      - nuclear-option
      - qa
      - testing
      - build
      - broken
      - failed

    documents:
      - id: "bok-direct-to-prod"
        path: "bok/anti-patterns/direct-to-production-deployment.md"
        title: "Direct-to-Production Deployment Anti-Pattern"
        summary: "Deploying without local testing, feature branches, or deploy previews"
        audience: [developers, devops, deployment-teams]
        urgency: high
        tags: [anti-pattern, deployment, qa-process]
        created: "2025-10-16"
        keywords: [deployment, production, testing, qa, git-workflow, anti-pattern]
        related_docs: [bok-nuclear-checklist, case-nuclear-recovery]

      - id: "case-nuclear-recovery"
        path: "docs/global-commons/case-studies/nuclear-option-incomplete-recovery.md"
        title: "Nuclear Option Without Complete Recovery"
        summary: "After delete/recreate, LLM marked config complete without verification - 60+ min outage"
        audience: [devops, deployment-teams, process-designers]
        urgency: critical
        tags: [nuclear-option, incomplete-recovery, todo-discipline, case-study]
        created: "2025-10-16"
        keywords: [nuclear-option, delete, recreate, recovery, verification, todo, build-settings]
        related_docs: [bok-nuclear-checklist, bok-direct-to-prod]
        user_quotes: ["i feel like claude.ai does this better than you"]

      - id: "bok-nuclear-checklist"
        path: "bok/processes/netlify-nuclear-option-recovery.md"
        title: "Netlify Nuclear Option Recovery Process"
        summary: "Complete checklist for delete/recreate workflow - build config, env vars, domains, DNS"
        audience: [netlify-users, devops, site-administrators]
        urgency: critical
        tags: [netlify, nuclear-option, recovery-checklist, process]
        created: "2025-10-16"
        keywords: [netlify, nuclear, recovery, checklist, build, environment-variables, dns, domains]
        related_docs: [case-nuclear-recovery, bok-hugo-version]
        platform: netlify

      - id: "bok-hugo-version"
        path: "bok/platforms/netlify/hugo-version-requirement.md"
        title: "Hugo Version Requirement for Netlify"
        summary: "Must set HUGO_VERSION env var - otherwise build fails with 'command not found'"
        audience: [hugo-developers, netlify-users, static-site-deployers]
        urgency: high
        tags: [netlify, hugo, environment-variables, platform-requirement]
        created: "2025-10-16"
        keywords: [netlify, hugo, version, environment-variable, build, command-not-found]
        related_docs: [bok-nuclear-checklist, case-nuclear-recovery]
        platform: netlify
        fix: "HUGO_VERSION=0.134.3 in environment variables"

      - id: "case-dns-outage"
        path: "docs/global-commons/case-studies/dns-outage-registrar-confusion.md"
        title: "DNS Outage from Registrar Confusion"
        summary: "LLM gave blanket DNS advice without checking registrar - production outage"
        audience: [devops, dns-administrators, system-architects]
        urgency: critical
        tags: [dns-outage, registrar-confusion, production-incident, case-study]
        created: "2025-10-16"
        keywords: [dns, registrar, outage, production, delete, netlify, squarespace, domain]
        related_docs: [bok-dns-ui-confusion]
        impact: "3 domains down ~10 minutes"

    related_clusters: [dns-configuration, platform-gotchas-netlify]
    urgency_distribution:
      critical: 3  # nuclear recovery case, checklist, dns outage
      high: 2      # direct-to-prod, hugo version

  # ---------------------------------------------------------------------------
  # CLUSTER 2: DNS Configuration & Domain Management
  # ---------------------------------------------------------------------------
  dns-configuration:
    description: "DNS setup, registrar management, and outage recovery"
    keywords:
      - dns
      - domain
      - registrar
      - nameserver
      - outage
      - not-resolving
      - squarespace
      - netlify-dns

    documents:
      - id: "case-dns-outage"
        # Same as in deployment-safety (cross-referenced)
        path: "docs/global-commons/case-studies/dns-outage-registrar-confusion.md"
        title: "DNS Outage from Registrar Confusion"
        summary: "LLM gave blanket DNS advice without checking registrar - production outage"
        audience: [devops, dns-administrators, system-architects]
        urgency: critical
        tags: [dns-outage, registrar-confusion, production-incident, case-study]
        created: "2025-10-16"
        keywords: [dns, registrar, outage, production, delete, netlify, squarespace, domain]
        related_docs: [bok-dns-ui-confusion]
        impact: "3 domains down ~10 minutes"

      - id: "bok-dns-ui-confusion"
        path: "bok/platforms/netlify/dns-configuration-ui-confusion.md"
        title: "Netlify DNS Configuration UI Confusion"
        summary: "Netlify doesn't show DNS records after domain add - where to actually configure"
        audience: [netlify-users, web-developers, dns-administrators]
        urgency: high
        tags: [netlify, dns, ui-confusion, squarespace, platform-gotcha]
        created: "2025-10-16"
        keywords: [netlify, dns, ui, squarespace, delete-first, registrar, configuration]
        related_docs: [case-dns-outage, bok-nuclear-checklist]
        platform: netlify

    related_clusters: [deployment-safety, platform-gotchas-netlify]
    urgency_distribution:
      critical: 1  # DNS outage case
      high: 1      # DNS UI confusion

  # ---------------------------------------------------------------------------
  # CLUSTER 3: LLM Communication Quality
  # ---------------------------------------------------------------------------
  llm-communication-quality:
    description: "How LLMs should communicate - completeness, accuracy, attribution, safety"
    keywords:
      - llm
      - instructions
      - incomplete
      - hallucination
      - attribution
      - communication
      - prerequisites
      - verification

    documents:
      - id: "case-incomplete-instructions"
        path: "docs/global-commons/case-studies/incomplete-instructions-pattern.md"
        title: "Incomplete Procedural Instructions Pattern"
        summary: "LLM omitted prerequisite steps identified minutes earlier - user frustration"
        audience: [technical-writers, llm-prompt-designers, documentation-teams]
        urgency: high
        tags: [incomplete-instructions, user-experience, communication, case-study]
        created: "2025-10-16"
        keywords: [incomplete, instructions, prerequisites, standalone, communication, frustration]
        related_docs: [case-name-hallucination, process-emergent-behavior]
        user_quotes: ["WHY DIDN'T YOU TELL ME THAT!"]
        lessons: ["Always include prerequisites", "Don't assume user memory", "Each instruction standalone"]

      - id: "case-name-hallucination"
        path: "docs/global-commons/case-studies/llm-name-hallucination-incident.md"
        title: "LLM Name Hallucination Incident"
        summary: "LLM hallucinated real-sounding name for pseudonymous user - doxxing risk"
        audience: [ai-safety-researchers, llm-system-designers, documentation-teams]
        urgency: critical
        tags: [privacy, hallucination, attribution, doxxing-risk, case-study]
        created: "2025-10-16"
        keywords: [hallucination, name, privacy, doxxing, attribution, pseudonym, github-handle]
        related_docs: [case-incomplete-instructions, process-vaporware-safeguard]
        lessons: ["Never infer real names", "Use provided handles", "Explicit consent for attribution"]

    related_clusters: [process-safeguards]
    urgency_distribution:
      critical: 1  # Name hallucination
      high: 1      # Incomplete instructions

  # ---------------------------------------------------------------------------
  # CLUSTER 4: Process Safeguards & Quality Control
  # ---------------------------------------------------------------------------
  process-safeguards:
    description: "Protocols and quality controls for documentation and system behavior"
    keywords:
      - process
      - protocol
      - safeguard
      - vaporware
      - emergent-behavior
      - fact-checking
      - quality-control

    documents:
      - id: "process-emergent-behavior"
        path: "docs/process/emergent-behavior-observation-protocol.md"
        title: "Emergent Behavior Observation Protocol"
        summary: "How to document unexpected LLM behaviors - permission protocol and classification"
        audience: [ai-researchers, llm-system-designers, documentation-teams]
        urgency: medium
        tags: [emergent-behavior, ai-capabilities, documentation, protocol]
        created: "2025-10-16"
        keywords: [emergent, behavior, llm, capabilities, permission, observed, reproduced, integrated]
        related_docs: [process-vaporware-safeguard, case-name-hallucination]
        lessons: ["LLMs must ASK before claiming capabilities", "User is decider", "Classification stages"]

      - id: "process-vaporware-safeguard"
        path: "docs/process/vaporware-safeguard.md"
        title: "Vaporware Safeguard"
        summary: "Prevent aspirational claims from becoming canon - FACT/OBSERVATION/VISION/SPECULATION"
        audience: [technical-writers, documentation-teams, product-managers]
        urgency: medium
        tags: [vaporware, fact-checking, documentation-quality, quality-control]
        created: "2025-10-16"
        keywords: [vaporware, aspirational, fact, observation, vision, speculation, safeguard]
        related_docs: [process-emergent-behavior, process-bok-injection]
        categories: ["FACT", "OBSERVATION", "VISION", "SPECULATION"]

      - id: "process-bok-injection"
        path: "docs/process/bok-context-injection-proposal.md"
        title: "BOK Context Injection Proposal"
        summary: "Auto-inject relevant BOK entries based on conversation keywords - prevent repeated mistakes"
        audience: [deia-system-designers, bot-developers, llm-integration-teams]
        urgency: medium
        tags: [bok, context-injection, automation, llm-integration, proposal]
        created: "2025-10-16"
        keywords: [bok, context, injection, automation, proactive, keywords, monitoring]
        related_docs: [process-emergent-behavior, process-vaporware-safeguard]
        status: "proposal"

    related_clusters: [llm-communication-quality]
    urgency_distribution:
      medium: 3  # All process docs

  # ---------------------------------------------------------------------------
  # CLUSTER 5: Platform-Specific Gotchas (Netlify)
  # ---------------------------------------------------------------------------
  platform-gotchas-netlify:
    description: "Netlify-specific requirements, limitations, and workarounds"
    note: "This is a VIEW on documents from other clusters, organized by platform"
    keywords:
      - netlify
      - platform
      - gotcha
      - requirement
      - hugo
      - environment-variables
      - dns
      - build

    documents:
      # Cross-references to docs in other clusters
      - bok-hugo-version          # From deployment-safety
      - bok-dns-ui-confusion      # From dns-configuration
      - bok-nuclear-checklist     # From deployment-safety
      - case-dns-outage           # From deployment-safety, dns-configuration
      - case-nuclear-recovery     # From deployment-safety

    related_clusters: [deployment-safety, dns-configuration]
    platform: netlify
    urgency_distribution:
      critical: 2  # nuclear checklist, dns outage
      high: 3      # hugo version, dns ui, nuclear case

  # ---------------------------------------------------------------------------
  # CLUSTER 6: Platform-Specific Gotchas (Windows/Python)
  # ---------------------------------------------------------------------------
  platform-gotchas-windows:
    description: "Windows-specific Python development issues and workarounds"
    keywords:
      - windows
      - python
      - console
      - utf8
      - encoding
      - unicode
      - emoji
      - platform-gotcha

    documents:
      - id: "bok-windows-python-utf8"
        path: "bok/platforms/windows/python-console-utf8-encoding.md"
        title: "Windows Python Console UTF-8 Encoding Issue"
        summary: "Windows console defaults to cp1252 - add UTF-8 wrapper for emoji/unicode output"
        audience: [python-developers, cli-tool-developers, windows-users]
        urgency: medium
        tags: [windows, python, utf8, console, encoding, platform-gotcha]
        created: "2025-10-16"
        keywords: [windows, python, utf8, encoding, console, emoji, unicode, cp1252, wrapper]
        recurrence_count: 20+
        cumulative_cost: "4-5 hours debugging across 20+ occurrences"
        fix: "Add io.TextIOWrapper UTF-8 encoding at script start"
        related_docs: []
        platform: windows
        language: python

    related_clusters: [process-safeguards]
    urgency_distribution:
      medium: 1  # Blocks execution but easy fix
    platform: windows
    language: python

  # ---------------------------------------------------------------------------
  # CLUSTER 7: DEIA System Architecture
  # ---------------------------------------------------------------------------
  deia-architecture:
    description: "DEIA system design, organizational patterns, and specifications"
    keywords:
      - deia
      - architecture
      - factory-egg
      - egg
      - offline
      - organizational-design
      - self-describing

    documents:
      - id: "article-factory-egg"
        path: "docs/articles/the-factory-egg.md"
        title: "The Factory Egg"
        summary: "Self-describing blueprints for organizational structures - implementation + philosophy"
        audience: [organizational-designers, system-architects, commons-contributors]
        urgency: low
        tags: [factory-egg, organizational-design, self-describing-systems, article]
        created: "2025-10-16"
        keywords: [factory, egg, organizational, blueprint, self-describing, philosophy, implementation]
        related_docs: [spec-offline-launch]
        author: "daaaave-atx × GPT-5 (Bot D)"
        editor: "Claude Code (Claude Sonnet 4.5)"
        license: "CC BY 4.0"
        status: "published"

      - id: "spec-offline-launch"
        path: "docs/specs/egg-offline-launch-capability.md"
        title: "Egg Offline Launch Capability"
        summary: "How Eggs work Commons-disconnected - graceful degradation with cached resources"
        audience: [system-implementers, egg-developers, architecture-teams]
        urgency: low
        tags: [egg, offline-mode, graceful-degradation, architecture, spec]
        created: "2025-10-16"
        keywords: [egg, offline, commons-disconnected, graceful-degradation, cached, local-ai]
        related_docs: [article-factory-egg]
        clarification: "offline = no network to Commons, NOT no AI"

    related_clusters: [process-safeguards]
    urgency_distribution:
      low: 2  # Architecture/philosophy docs

# ==============================================================================
# QUERY PATTERNS
# Common ways agents ask for help → which cluster/docs to check
# ==============================================================================

query_patterns:
  - query_keywords: [deployment, failed, failure, broken, down]
    natural_language: ["deployment failed", "my deployment is broken", "deploy not working", "site is down"]
    primary_cluster: deployment-safety
    urgency: critical
    common_docs: [bok-direct-to-prod, case-nuclear-recovery, bok-nuclear-checklist]

  - query_keywords: [dns, domain, not-resolving, outage]
    natural_language: ["DNS not working", "domain not resolving", "DNS outage"]
    primary_cluster: dns-configuration
    urgency: critical
    common_docs: [case-dns-outage, bok-dns-ui-confusion]

  - query_keywords: [llm, instructions, incomplete, wrong, bad]
    natural_language: ["LLM gave bad instructions", "instructions missing steps", "incomplete guidance"]
    primary_cluster: llm-communication-quality
    urgency: high
    common_docs: [case-incomplete-instructions]

  - query_keywords: [nuclear, delete, recreate, recovery]
    natural_language: ["I'm deleting and recreating", "nuclear option", "recovery checklist"]
    primary_cluster: deployment-safety
    urgency: critical
    proactive_injection: true  # Inject BEFORE user proceeds
    common_docs: [bok-nuclear-checklist, case-nuclear-recovery]
    warning_message: "⚠️ Detected 'nuclear option' - complete recovery checklist required to prevent 60+ min outage"

  - query_keywords: [hallucination, name, privacy, attribution]
    natural_language: ["LLM hallucinated", "privacy issue", "attribution problem"]
    primary_cluster: llm-communication-quality
    urgency: critical
    common_docs: [case-name-hallucination]

  - query_keywords: [netlify, platform]
    natural_language: ["Netlify documentation", "platform-specific Netlify", "Netlify gotchas"]
    primary_cluster: platform-gotchas-netlify
    urgency: high
    common_docs: [bok-hugo-version, bok-dns-ui-confusion, bok-nuclear-checklist]

  - query_keywords: [factory, egg, organizational, deia, architecture]
    natural_language: ["How does Factory Egg work", "organizational design", "Egg system", "DEIA architecture"]
    primary_cluster: deia-architecture
    urgency: low
    common_docs: [article-factory-egg, spec-offline-launch]

  - query_keywords: [prevent, mistake, safeguard, quality]
    natural_language: ["how do we prevent mistakes", "quality control", "fact-checking"]
    primary_cluster: process-safeguards
    urgency: medium
    common_docs: [process-vaporware-safeguard, process-bok-injection]

  - query_keywords: [windows, python, encoding, utf8, emoji, unicode, console]
    natural_language: ["Python emoji not working", "Windows encoding error", "UnicodeEncodeError Windows", "charmap codec error"]
    primary_cluster: platform-gotchas-windows
    urgency: medium
    common_docs: [bok-windows-python-utf8]
    error_pattern: "UnicodeEncodeError: 'charmap' codec can't encode character"

# ==============================================================================
# PROACTIVE INJECTION TRIGGERS
# Patterns to watch for in conversations - inject BEFORE user makes mistake
# ==============================================================================

proactive_triggers:
  - pattern: ["delete", "netlify"]
    alternate_patterns: ["recreate", "nuclear", "start over"]
    action: inject_before_proceeding
    documents: [bok-nuclear-checklist, case-nuclear-recovery]
    urgency: critical
    message: "⚠️ I have a complete recovery checklist for delete/recreate. Review before proceeding to avoid 60+ min outage."

  - pattern: ["dns", "configure"]
    alternate_patterns: ["add domain", "dns records"]
    action: ask_clarifying_question
    documents: [case-dns-outage, bok-dns-ui-confusion]
    urgency: high
    message: "Before configuring DNS, where is this domain registered? (Netlify vs external registrar)"

  - pattern: ["deploy", "production"]
    exclude_keywords: ["test", "preview", "local"]
    action: suggest_best_practice
    documents: [bok-direct-to-prod]
    urgency: high
    message: "I see you're deploying to production. Have you tested locally and used deploy preview?"

# ==============================================================================
# PLATFORM INDEX
# Quick access to all platform-specific documentation
# ==============================================================================

platform_index:
  netlify:
    - bok-dns-ui-confusion
    - bok-hugo-version
    - bok-nuclear-checklist
    - case-dns-outage
    - case-nuclear-recovery

  squarespace:
    - bok-dns-ui-confusion  # Squarespace-specific delete-first requirement

  windows:
    - bok-windows-python-utf8  # Python console UTF-8 encoding issue

# ==============================================================================
# AUDIENCE INDEX
# Documentation organized by who needs it
# ==============================================================================

audience_index:
  devops:
    clusters: [deployment-safety, dns-configuration, platform-gotchas-netlify]
    critical_docs: [case-dns-outage, case-nuclear-recovery, bok-nuclear-checklist]
    high_docs: [bok-direct-to-prod, bok-dns-ui-confusion, bok-hugo-version]

  developers:
    clusters: [deployment-safety, platform-gotchas-netlify]
    critical_docs: [bok-nuclear-checklist]
    high_docs: [bok-direct-to-prod, bok-hugo-version]

  ai-researchers:
    clusters: [llm-communication-quality, process-safeguards, deia-architecture]
    critical_docs: [case-name-hallucination]
    high_docs: [case-incomplete-instructions]
    medium_docs: [process-emergent-behavior, process-vaporware-safeguard]

  llm-system-designers:
    clusters: [llm-communication-quality, process-safeguards]
    critical_docs: [case-name-hallucination]
    high_docs: [case-incomplete-instructions]
    medium_docs: [process-emergent-behavior, process-bok-injection]

  technical-writers:
    clusters: [llm-communication-quality, process-safeguards]
    high_docs: [case-incomplete-instructions]
    medium_docs: [process-vaporware-safeguard]

  system-architects:
    clusters: [deia-architecture, process-safeguards]
    low_docs: [article-factory-egg, spec-offline-launch]

# ==============================================================================
# URGENCY INDEX
# Fast access for production incidents vs learning
# ==============================================================================

urgency_index:
  critical:
    description: "Production down, immediate action required"
    documents:
      - case-dns-outage
      - case-nuclear-recovery
      - bok-nuclear-checklist
      - case-name-hallucination
    common_scenarios:
      - "DNS outage"
      - "Deployment broken after nuclear option"
      - "Privacy violation"

  high:
    description: "Deployment/recovery, high user impact"
    documents:
      - case-incomplete-instructions
      - bok-direct-to-prod
      - bok-dns-ui-confusion
      - bok-hugo-version
    common_scenarios:
      - "Deployment failures"
      - "Incomplete instructions causing frustration"
      - "Platform-specific gotchas"

  medium:
    description: "Process improvements, prevention"
    documents:
      - process-emergent-behavior
      - process-vaporware-safeguard
      - process-bok-injection
    common_scenarios:
      - "Quality control"
      - "Documentation protocols"
      - "System improvements"

  low:
    description: "Architecture, philosophy, background learning"
    documents:
      - article-factory-egg
      - spec-offline-launch
    common_scenarios:
      - "Understanding DEIA architecture"
      - "Learning organizational design patterns"

# ==============================================================================
# STATISTICS
# ==============================================================================

statistics:
  by_type:
    case_studies: 4
    bok_entries: 5  # Added Windows Python UTF-8 encoding
    process_docs: 3
    articles: 1
    specs: 1

  by_urgency:
    critical: 4
    high: 5
    medium: 4  # Added Windows Python UTF-8 encoding
    low: 2

  by_audience:
    devops: 8
    developers: 6  # Added Python developers
    ai-researchers: 6
    llm-system-designers: 5
    technical-writers: 3
    system-architects: 3

  by_cluster:
    deployment-safety: 5
    dns-configuration: 2
    llm-communication-quality: 2
    process-safeguards: 3
    platform-gotchas-netlify: 5  # (cross-referenced view)
    platform-gotchas-windows: 1  # Python console UTF-8 encoding
    deia-architecture: 2
