# Queen Orders Protocol (LLM-agnostic)

Single source of truth for expectations: `.deia/bot-status-board.json`

## File Schema
Board fields to use:
- Top-level `rev` (ISO timestamp) â€” bump on any order change
- Under `bots.<BOT_ID>`: `task_id`, `status`, `expectation`, `instructions_path`

## Drone Auto-Check Loop
- Every 3â€“5 minutes, a drone MUST:
  1. Read `.deia/bot-status-board.json`
  2. Compare `rev` with the last applied value
  3. If changed OR if `bots[<bot_id>]` fields changed, then:
     - Update its own instruction file `## Current Task` to reflect the orders
     - Send a heartbeat: `Orders applied (<task_id>)`
     - Continue work as directed

## Queen Workflow
- Edit `.deia/bot-status-board.json` and bump `rev` to issue new orders
- Optional: broadcast a chat message reminding drones to apply orders
- Keep instruction files as human-friendly mirrors; JSON is the source of truth
- Human Requests Rule: any request to a human MUST point to a single `.md` file to open and follow (human-readable, bot-executable). Prefer existing launch/assignment docs under `.deia/`.

### Queen Turn Loop (Player/Coach)
- Read board and per-bot instructions (type the files)
- Set/advance tasks in the board (status/task_id/expectation), bump `rev`, and point bots to their instruction files
- Pick one job yourself (docs/link suggestions) and advance it by assigning the next single step
- Keep changes minimal and reversible; prefer `.deia/` docs and workers over core code edits

## Telemetry
- Drones log an `orders_check` event to `.deia/bot-logs/<BOT>-activity.jsonl` when they check, and an `orders_apply` when they update.

### Output Signature Rule (All Bots)
- After producing any output (file/report/notes), append a final line identifying the bot:
  - Generated by <BOT-ID> (e.g., Generated by BOT-00003)
- Include the bot ID in the completion heartbeat message.


### Scope Allowlist (Safety)
- The board MAY include a scope object to constrain bot activity:
  - llowed_dirs: list of repo-relative paths that are in-scope
  - deny_dirs: list of paths that are explicitly out-of-scope
- Bots MUST verify scope before acting and avoid any deny_dirs.
- Queens SHOULD set scope to DEIA-only during coordination (e.g., disallow lappy-bird-ai/).

